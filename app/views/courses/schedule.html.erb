<div class="container-fluid">
  <div class="row">
    <div class="col-sm-2">
      <%= render "shared/sidenav" %>

    </div>
    <div class="col-sm-10">
      <div class="panel panel-primary">
        <div class="panel-heading">
          <h3 class="panel-title">我的课表</h3>
        </div>
        <div class="panel-body" style="min-height: 450px">
          <table class="table table-striped table-hover" border="2">

            <thead>
            <tr>
              <th style="width:9%"></th>
              <th style="width:13%">周一</th>
              <th style="width:13%">周二</th>
              <th style="width:13%">周三</th>
              <th style="width:13%">周四</th>
              <th style="width:13%">周五</th>
              <th style="width:13%">周六</th>
              <th style="width:13%">周日</th>
            </tr>
            </thead>
            <tbody>
            <% courselist=Array.new(12){Array.new(8)} %>
            <% empty_or_length=Array.new(12){Array.new(8)} %>
                <% @course=current_user.courses %>
                <% @course.each do |course| %>
                  <% if course.course_time.length>5 %>
                    <% temp_str=course.course_time.split %>
                    <% i=temp_str[0].to_i/100%100  %>
                    <% j=temp_str[0].to_i/10000  %>
                    <% k=temp_str[0].to_i%100 %>
                    <% courselist[i][j]=course  %>
                    <% empty_or_length[i][j]=k-i+1 %>
                    <% m=0 %>
                    <% while k-i-m>0 do %>
                      <% empty_or_length[i+1+m][j]=1%>
                      <% m=m+1 %>
                    <% end %>
                    
                    <% i=temp_str[1].to_i/100%100   %>
                    <% j=temp_str[1].to_i/10000   %>
                    <% k=temp_str[1].to_i%100 %>
                    <% courselist[i][j]=course   %>
                    <% empty_or_length[i][j]=k-i+1 %>
                    <% m=0 %>
                    <% while k-i-m>0 do %>
                      <% empty_or_length[i+1+m][j]=1%>
                      <% m=m+1 %>
                    <% end %>
                  <% end  %>
                  <% if course.course_time.length<=5 %>
                    <% i=course.course_time.to_i/100%100 %>
                    <% j=course.course_time.to_i/10000 %>
                    <% k=course.course_time.to_i%100 %>
                    <% courselist[i][j]=course %>
                    <% empty_or_length[i][j]=k-i+1 %>
                    <% m=0 %>
                    <% while k-i-m>0 do %>
                      <% empty_or_length[i+1+m][j]=1%>
                      <% m=m+1 %>
                    <% end %>
                  <% end %>
                <% end %>
            <% b=1 %>
            <% while b<12 do %>
              <tr>
                <td><%="第#{b}节"%></td>
              <% a=1 %>
              <% while a<8 do %>
                <% if courselist[b][a]!=nil %>
                  <% time_str1 = "第#{courselist[b][a].start_week}~#{courselist[b][a].end_week}周" %>
                  <% time_str2 = Hashes.time_to_str(courselist[b][a].course_time) %>
                  <% case empty_or_length[b][a] %>
                    <% when 1 %>
                    <td rowspan="1"><%=courselist[b][a].name %><br><%= time_str1 %><br><%= time_str2 %></td>
                    <% when 2 %>
                    <td rowspan="2"><%=courselist[b][a].name %><br><%= time_str1 %><br><%= time_str2 %></td>
                    <% when 3 %>
                    <td rowspan="3"><%=courselist[b][a].name %><br><%= time_str1 %><br><%= courselist[b][a].building+"  "+courselist[b][a].class_room %></td>
                    <% when 4 %>
                    <td rowspan="4"><%=courselist[b][a].name %><br><%= time_str1 %><br><%= time_str2 %></td>
                  <% end %>
                <% else %>
                
                  <% if empty_or_length[b][a]!=1 %>
                    <td><% %></td>
                  <% end %>
                <% end %> 
                <% a=a+1 %>
              <% end %>
              </tr>
              <% b=b+1 %>
            <% end %>
            
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>


